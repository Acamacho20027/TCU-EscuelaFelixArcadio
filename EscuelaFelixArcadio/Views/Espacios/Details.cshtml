@model EscuelaFelixArcadio.Models.Espacio

@{
    ViewBag.Title = "Detalles de Espacio";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
    
    var statusClass = "";
    var estadoDescripcion = Model.Estado.Descripcion.ToLower();
    
    if (estadoDescripcion.Contains("activ"))
    {
        statusClass = "success";
    }
    else if (estadoDescripcion.Contains("inactivo"))
    {
        statusClass = "error";
    }
    else if (estadoDescripcion.Contains("mantenimiento"))
    {
        statusClass = "warning";
    }
    else
    {
        statusClass = "info";
    }
}

@section Styles {
    <link href="~/Content/espacios.css" rel="stylesheet" />
}

<div class="espacios-container">
    <div class="espacios-details-container">
        <h2 class="espacios-details-title">Detalles del Espacio</h2>

        <!-- Informacion principal -->
        <div class="espacios-details-card">
            <h3 class="espacios-details-card-title">
                <i class="fas fa-building"></i> Informacion General
            </h3>
            <div class="espacios-details-grid">
                <div class="espacios-details-field">
                    <label class="espacios-details-label">ID del Espacio</label>
                    <div class="espacios-details-value">
                        <i class="fas fa-hashtag"></i> @Model.IdEspacio
                    </div>
                </div>

                <div class="espacios-details-field">
                    <label class="espacios-details-label">Codigo</label>
                    <div class="espacios-details-value">
                        <i class="fas fa-barcode"></i> @Model.Codigo
                    </div>
                </div>

                <div class="espacios-details-field">
                    <label class="espacios-details-label">Nombre</label>
                    <div class="espacios-details-value">
                        <i class="fas fa-tag"></i> @Model.Nombre
                    </div>
                </div>

                <div class="espacios-details-field">
                    <label class="espacios-details-label">Estado</label>
                    <div class="espacios-details-value">
                        @if (statusClass == "error")
                        {
                            <span class="espacios-status-badge @statusClass" style="background: #fee2e2 !important; color: #991b1b !important; border: 1px solid #fecaca !important;">
                                @Model.Estado.Descripcion
                            </span>
                        }
                        else
                        {
                            <span class="espacios-status-badge @statusClass">
                                @Model.Estado.Descripcion
                            </span>
                        }
                    </div>
                </div>

                <div class="espacios-details-field">
                    <label class="espacios-details-label">Capacidad</label>
                    <div class="espacios-details-value">
                        <i class="fas fa-users"></i> @(Model.Capacidad.HasValue ? Model.Capacidad.Value.ToString() + " personas" : "No especificada")
                    </div>
                </div>

                <div class="espacios-details-field">
                    <label class="espacios-details-label">Ubicacion</label>
                    <div class="espacios-details-value">
                        <i class="fas fa-map-marker-alt"></i> @(Model.Ubicacion ?? "No especificada")
                    </div>
                </div>
            </div>
        </div>

        <!-- Fecha de creacion -->
        <div class="espacios-details-card">
            <h3 class="espacios-details-card-title">
                <i class="fas fa-calendar-alt"></i> Informacion de Registro
            </h3>
            <div class="espacios-details-grid">
                <div class="espacios-details-field">
                    <label class="espacios-details-label">Fecha de Creacion</label>
                    <div class="espacios-details-value">
                        <i class="fas fa-calendar-plus"></i> @Model.FechaCreacion.ToString("dd/MM/yyyy HH:mm:ss")
                    </div>
                </div>
            </div>
        </div>

        <!-- Descripcion -->
        @if (!string.IsNullOrEmpty(Model.Descripcion))
        {
            <div class="espacios-details-card">
                <h3 class="espacios-details-card-title">
                    <i class="fas fa-sticky-note"></i> Descripcion
                </h3>
                <div class="espacios-details-field" style="grid-column: 1 / -1;">
                    <div class="espacios-details-value" style="white-space: pre-wrap; line-height: 1.6;">
                        @Model.Descripcion
                    </div>
                </div>
            </div>
        }

        <!-- Botones de accion -->
        <div class="espacios-form-buttons">
            <a href="@Url.Action("Edit", new { id = Model.IdEspacio })" class="btn-espacios-save">
                <i class="fas fa-edit"></i> Editar Espacio
            </a>
            <a href="@Url.Action("Index")" class="btn-espacios-cancel">
                Regresar a la Lista
            </a>
        </div>
    </div>
</div>

<script>
    // Forzar estilos para estados inactivos en Details
    (function() {
        function aplicarEstilosInactivos() {
            // Buscar por texto "Inactivo"
            var elementos = document.querySelectorAll('span');
            elementos.forEach(function(elemento) {
                if (elemento.textContent && elemento.textContent.trim() === 'Inactivo') {
                    elemento.style.cssText = 'background: #fee2e2 !important; background-color: #fee2e2 !important; color: #991b1b !important; border: 1px solid #fecaca !important;';
                }
            });
            
            // También buscar por clase
            var elementosClase = document.querySelectorAll('.espacios-status-badge.error, .espacios-status-badge.inactivo');
            elementosClase.forEach(function(elemento) {
                elemento.style.cssText = 'background: #fee2e2 !important; background-color: #fee2e2 !important; color: #991b1b !important; border: 1px solid #fecaca !important;';
            });
        }
        
        // Ejecutar inmediatamente
        aplicarEstilosInactivos();
        
        // Ejecutar cuando el DOM esté listo
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', aplicarEstilosInactivos);
        }
        
        // Ejecutar múltiples veces
        setTimeout(aplicarEstilosInactivos, 10);
        setTimeout(aplicarEstilosInactivos, 50);
        setTimeout(aplicarEstilosInactivos, 100);
        setTimeout(aplicarEstilosInactivos, 200);
        setTimeout(aplicarEstilosInactivos, 500);
        setTimeout(aplicarEstilosInactivos, 1000);
    })();
</script>
